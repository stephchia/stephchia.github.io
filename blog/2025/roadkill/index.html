<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Mapping roadkill risk in Taiwan with MaxEnt | Stephanie Chia </title> <meta name="author" content="Stephanie Chia"> <meta name="description" content="R workflow for mapping roadkill risk on Taiwan's highway network using MaxEnt (presence-only species distribution modeling)"> <meta name="keywords" content="ecoinformatics, ecology, evolution, macroecology, macroevolution, ecologist, phd, data science, environment"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link rel="preconnect" href="https://fonts.googleapis.com"> <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin> <link href="https://fonts.googleapis.com/css2?family=Klee+One&amp;family=LXGW+WenKai+TC&amp;family=Yuji+Boku&amp;display=swap" rel="stylesheet"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link defer href="/assets/css/bootstrap-toc.min.css?6f5af0bb9aab25d79b2448143cbeaa88" rel="stylesheet"> <link rel="shortcut icon" href="/assets/img/favicon.png?16a68f269ad8c4b8ec613166def673ad"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://stephchia.github.io/blog/2025/roadkill/"> <script src="/assets/js/theme.js?a81d82887dd692e91686b43de4542f18"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav sticky-bottom-footer"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> Stephanie Chia <span class="zh">賈媛</span> </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About </a> </li> <li class="nav-item "> <a class="nav-link" href="/research/">Research </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">Publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">Teaching </a> </li> <li class="nav-item "> <a class="nav-link" href="/posts/index.html">Posts </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="row"> <div class="col-sm-3"> <nav id="toc-sidebar" class="sticky-top"></nav> </div> <div class="col-sm-9"> <div class="post"> <header class="post-header"> <h1 class="post-title">Mapping roadkill risk in Taiwan with MaxEnt</h1> <p class="post-meta"> Created on August 26, 2025 </p> <p class="post-tags"> <a href="/blog/2025"> <i class="fa-solid fa-calendar fa-sm"></i> 2025 </a>   ·   <a href="/blog/tag/maxent"> <i class="fa-solid fa-hashtag fa-sm"></i> Maxent</a>   <a href="/blog/tag/r"> <i class="fa-solid fa-hashtag fa-sm"></i> R</a>   <a href="/blog/tag/sdm"> <i class="fa-solid fa-hashtag fa-sm"></i> SDM</a>   ·   <a href="/blog/category/workflow"> <i class="fa-solid fa-tag fa-sm"></i> workflow</a> </p> </header> <article class="post-content"> <div id="markdown-content"> <blockquote> <p>Code and data on <a href="https://github.com/stephchia/roadkill-sdm" rel="external nofollow noopener" target="_blank">Github</a></p> </blockquote> <p>This note demonstrates how to map roadkill risk in Taiwan using MaxEnt, a presence-only species distribution modeling (SDM) approach. We combine environmental predictors with roadkill occurrences reported by a citizen-science project to estimate a relative risk surface.</p> <p>This side project was initiated as a submission to the Taiwan Highway Bureau Data Innovative Application Competition, developed in collaboration with <a href="https://scholar.google.com/citations?user=y3MxyWEAAAAJ&amp;hl=en" rel="external nofollow noopener" target="_blank">Le Quang Tuan</a> and several friends.</p> <hr> <h2 id="background">Background</h2> <p>The <a href="https://roadkill.tw/" rel="external nofollow noopener" target="_blank">Taiwan Roadkill Observation Network (TRON)</a> has crowd-sourced wildlife-vehicle collision observations since 2011, now accumulated 300,000+ records with species, location, date, and more (a subset of the data is released on GBIF). For a relatively small island, the spatial sampling is dense, offering strong potential for high-resolution risk mapping.</p> <p><a href="https://biodiversityinformatics.amnh.org/open_source/maxent/" rel="external nofollow noopener" target="_blank">MaxEnt</a> (maximum entropy) works with such presence-only data. It contrasts the environments at presence sites with background samples to estimate a smooth relative suitability surface. Here, instead of speices occurrance for distribution range mapping, we treat roadkill occurrances as presences to model the spatial pattern of relative roadkill risk (focused on the road network).</p> <hr> <h2 id="workflow">Workflow</h2> <h3 id="data-sources-all-open-data">Data sources (all open data)</h3> <ul> <li>Occurence data: <a href="https://www.gbif.org/dataset/db09684b-0fd1-431e-b5fa-4c1532fbdb14" rel="external nofollow noopener" target="_blank">TRON Roadkill data on GBIF</a> (years 2011-2017, ~46,000 records)</li> <li>Modeling target: <a href="https://www.thb.gov.tw/News_Content_thbOpenData.aspx?n=13&amp;s=490" rel="external nofollow noopener" target="_blank">Taiwan highway network (vector)</a> </li> <li>Environmental predictors: <ul> <li>Land cover: <a href="https://zenodo.org/records/7254221" rel="external nofollow noopener" target="_blank">WorldCover 10 m 2021 v200</a> </li> <li>Vegetation: <a href="https://scidm.nchc.org.tw/dataset/best_wish9930" rel="external nofollow noopener" target="_blank">Atlas of Natural Vegetation in Taiwan</a> (not on Github due to file size limit)</li> </ul> </li> </ul> <h3 id="i-prepare-data">I. Prepare data</h3> <h4 id="1-initialization">1. Initialization</h4> <p>Load required libraries</p> <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="n">terra</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">sp</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">dplyr</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">dismo</span><span class="p">)</span><span class="w">
</span></code></pre></div></div> <p>Create raster template</p> <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">rast</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">rast</span><span class="p">(</span><span class="n">ext</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ext</span><span class="p">(</span><span class="m">120</span><span class="p">,</span><span class="w"> </span><span class="m">122.1</span><span class="p">,</span><span class="w"> </span><span class="m">21.8</span><span class="p">,</span><span class="w"> </span><span class="m">25.4</span><span class="p">),</span><span class="w"> </span><span class="n">resolution</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.0009</span><span class="p">,</span><span class="w"> </span><span class="n">crs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"EPSG:4326"</span><span class="p">)</span><span class="w">  </span><span class="c1"># WGS84 CRS</span><span class="w">
</span></code></pre></div></div> <h4 id="2-rasterize-road-data">2. Rasterize road data</h4> <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">road.vec</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">st_read</span><span class="p">(</span><span class="s2">"data_input/highway/highway.shp"</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">st_transform</span><span class="p">(</span><span class="n">crs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">4326</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">rasterize</span><span class="p">(</span><span class="n">rast</span><span class="p">,</span><span class="w"> </span><span class="n">touches</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">road</span><span class="p">)</span><span class="w">
</span></code></pre></div></div> <p><img src="/assets/img/post/20250826/01.png" alt="image" width="40%"></p> <h4 id="3-prepare-land-cover-layer">3. Prepare land cover layer</h4> <p>Combine two datasets: vegetation type (for natural vegetation) and WorldCover (for other land types). Vegetation classes take precedence where available.</p> <h5 id="31-create-raster-of-taiwan-island">3.1 Create raster of Taiwan island</h5> <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">taiwan.vec</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">st_read</span><span class="p">(</span><span class="s2">"data/Taiwan_diss/Taiwan_diss.shp"</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">st_transform</span><span class="p">(</span><span class="n">crs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">4326</span><span class="p">)</span><span class="w">
</span><span class="n">taiwan.vec</span><span class="o">$</span><span class="n">value</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">1</span><span class="w">
</span><span class="n">taiwan</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">vect</span><span class="p">(</span><span class="n">taiwan.vec</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">buffer</span><span class="p">(</span><span class="n">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">100</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">rasterize</span><span class="p">(</span><span class="n">rast</span><span class="p">,</span><span class="w"> </span><span class="n">field</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"value"</span><span class="p">,</span><span class="w"> </span><span class="n">background</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NA</span><span class="p">)</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">taiwan</span><span class="p">)</span><span class="w">
</span></code></pre></div></div> <p><img src="/assets/img/post/20250826/02.png" alt="image" width="40%"></p> <h5 id="32-process-vegetation-data-each-integer-represent-a-vegetation-type">3.2 Process vegetation data (each integer represent a vegetation type)</h5> <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">vegetation.vec</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">st_read</span><span class="p">(</span><span class="s2">"data/vegetation/ACO0301000011021.shp"</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">st_transform</span><span class="p">(</span><span class="n">crs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">4326</span><span class="p">)</span><span class="w">
</span><span class="n">veg_levels</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">unique</span><span class="p">(</span><span class="n">vegetation.vec</span><span class="o">$</span><span class="n">FORMATION</span><span class="p">)[</span><span class="nf">c</span><span class="p">(</span><span class="m">23</span><span class="p">,</span><span class="m">19</span><span class="p">,</span><span class="m">10</span><span class="p">,</span><span class="m">9</span><span class="p">,</span><span class="m">35</span><span class="p">,</span><span class="m">17</span><span class="p">,</span><span class="m">16</span><span class="p">,</span><span class="m">38</span><span class="p">,</span><span class="m">20</span><span class="p">,</span><span class="m">7</span><span class="p">,</span><span class="m">26</span><span class="p">,</span><span class="m">37</span><span class="p">,</span><span class="m">24</span><span class="p">,</span><span class="m">15</span><span class="p">,</span><span class="w">
                                                </span><span class="m">8</span><span class="p">,</span><span class="m">4</span><span class="p">,</span><span class="m">14</span><span class="p">,</span><span class="m">32</span><span class="p">,</span><span class="m">5</span><span class="p">,</span><span class="m">29</span><span class="p">,</span><span class="m">27</span><span class="p">,</span><span class="m">18</span><span class="p">,</span><span class="m">25</span><span class="p">,</span><span class="m">30</span><span class="p">,</span><span class="m">28</span><span class="p">,</span><span class="m">12</span><span class="p">,</span><span class="m">6</span><span class="p">,</span><span class="m">33</span><span class="p">,</span><span class="m">21</span><span class="p">,</span><span class="w">
                                                </span><span class="m">13</span><span class="p">,</span><span class="m">36</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">22</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">11</span><span class="p">,</span><span class="m">31</span><span class="p">,</span><span class="m">34</span><span class="p">)]</span><span class="w">
</span><span class="n">formation_mapping</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">setNames</span><span class="p">(</span><span class="m">12</span><span class="o">:</span><span class="p">(</span><span class="m">11</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">length</span><span class="p">(</span><span class="n">veg_levels</span><span class="p">)),</span><span class="w"> </span><span class="n">veg_levels</span><span class="p">)</span><span class="w">
</span><span class="n">vegetation.vec</span><span class="o">$</span><span class="n">Formation_int</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">formation_mapping</span><span class="p">[</span><span class="n">vegetation.vec</span><span class="o">$</span><span class="n">FORMATION</span><span class="p">]</span><span class="w">
</span><span class="n">vegetation</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">rasterize</span><span class="p">(</span><span class="n">vegetation.vec</span><span class="p">,</span><span class="w"> </span><span class="n">rast</span><span class="p">,</span><span class="w"> </span><span class="n">field</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Formation_int"</span><span class="p">,</span><span class="w"> </span><span class="n">background</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NA</span><span class="p">)</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">vegetation</span><span class="p">)</span><span class="w"> </span><span class="c1"># left figure</span><span class="w">
</span></code></pre></div></div> <h5 id="33-process-worldcover-data-each-integer-represents-a-land-cover-type">3.3 Process WorldCover data (each integer represents a land cover type)</h5> <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">worldcover</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">merge</span><span class="p">(</span><span class="n">rast</span><span class="p">(</span><span class="s2">"data/landcover/ESA_WorldCover_10m_2021_v200_N21E117_Map.tif"</span><span class="p">),</span><span class="w">
                    </span><span class="n">rast</span><span class="p">(</span><span class="s2">"data/landcover/ESA_WorldCover_10m_2021_v200_N21E120_Map.tif"</span><span class="p">),</span><span class="w">
                    </span><span class="n">rast</span><span class="p">(</span><span class="s2">"data/landcover/ESA_WorldCover_10m_2021_v200_N24E120_Map.tif"</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">project</span><span class="p">(</span><span class="n">rast</span><span class="p">,</span><span class="w"> </span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"near"</span><span class="p">)</span><span class="w">
</span><span class="n">worldcover</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">worldcover</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">taiwan</span><span class="w"> </span><span class="c1"># extract land cover data only within the island</span><span class="w">
</span><span class="n">worldcover_mapping</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">setNames</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">11</span><span class="p">,</span><span class="w">  </span><span class="nf">c</span><span class="p">(</span><span class="m">10</span><span class="p">,</span><span class="m">20</span><span class="p">,</span><span class="m">30</span><span class="p">,</span><span class="m">40</span><span class="p">,</span><span class="m">50</span><span class="p">,</span><span class="m">60</span><span class="p">,</span><span class="m">70</span><span class="p">,</span><span class="m">80</span><span class="p">,</span><span class="m">90</span><span class="p">,</span><span class="m">95</span><span class="p">,</span><span class="m">100</span><span class="p">))</span><span class="w">
</span><span class="n">values</span><span class="p">(</span><span class="n">worldcover</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">worldcover_mapping</span><span class="p">[</span><span class="nf">as.character</span><span class="p">(</span><span class="n">values</span><span class="p">(</span><span class="n">worldcover</span><span class="p">))]</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">worldcover</span><span class="p">)</span><span class="w"> </span><span class="c1"># middle figure</span><span class="w">
</span></code></pre></div></div> <h5 id="34-combine-venetation-and-worldcover-data">3.4 Combine venetation and WorldCover data</h5> <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">unique</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">values</span><span class="p">(</span><span class="n">vegetation</span><span class="p">),</span><span class="w"> </span><span class="n">values</span><span class="p">(</span><span class="n">worldcover</span><span class="p">)))</span><span class="w">
</span><span class="n">land</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">worldcover</span><span class="w">
</span><span class="n">idx</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">which</span><span class="p">(</span><span class="o">!</span><span class="nf">is.na</span><span class="p">(</span><span class="n">values</span><span class="p">(</span><span class="n">vegetation</span><span class="p">)))</span><span class="w">
</span><span class="n">values</span><span class="p">(</span><span class="n">land</span><span class="p">)[</span><span class="n">idx</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">values</span><span class="p">(</span><span class="n">vegetation</span><span class="p">)[</span><span class="n">idx</span><span class="p">]</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">land</span><span class="p">)</span><span class="w"> </span><span class="c1"># right figure</span><span class="w">
</span><span class="n">writeRaster</span><span class="p">(</span><span class="n">land</span><span class="p">,</span><span class="w"> </span><span class="s2">"data/land.tif"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div> <p><img src="/assets/img/post/20250826/03.png" alt="image" width="30%"> <img src="/assets/img/post/20250826/04.png" alt="image" width="30%"> <img src="/assets/img/post/20250826/05.png" alt="image" width="30%"></p> <p>(rendered in continuous color palette, but these are caterogical data)</p> <h4 id="4-create-distance-to-water-layer">4. Create “distance to water” layer</h4> <p>Compute distance to water (only for the road cells to save computation time)</p> <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">water</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">land</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">8</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">water</span><span class="p">)</span><span class="w">
</span><span class="n">values</span><span class="p">(</span><span class="n">water</span><span class="p">)[</span><span class="n">which</span><span class="p">(</span><span class="nf">is.na</span><span class="p">(</span><span class="n">values</span><span class="p">(</span><span class="n">water</span><span class="p">)))]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kc">FALSE</span><span class="w">

</span><span class="n">roadwater</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">water</span><span class="w">
</span><span class="n">values</span><span class="p">(</span><span class="n">roadwater</span><span class="p">)[</span><span class="n">which</span><span class="p">(</span><span class="n">values</span><span class="p">(</span><span class="n">road</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">)]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kc">NA</span><span class="w">
</span><span class="n">dist_to_water</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">distance</span><span class="p">(</span><span class="n">roadwater</span><span class="p">,</span><span class="w"> </span><span class="n">target</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NA</span><span class="p">,</span><span class="w"> </span><span class="n">exclude</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span><span class="w">
</span><span class="c1"># plot(dist_to_water)</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">crop</span><span class="p">(</span><span class="n">dist_to_water</span><span class="p">,</span><span class="w"> </span><span class="n">ext</span><span class="p">(</span><span class="m">120.3</span><span class="p">,</span><span class="w"> </span><span class="m">120.5</span><span class="p">,</span><span class="w"> </span><span class="m">23.6</span><span class="p">,</span><span class="w"> </span><span class="m">23.8</span><span class="p">)))</span><span class="w"> </span><span class="c1"># zoom in</span><span class="w">

</span><span class="n">writeRaster</span><span class="p">(</span><span class="n">dist_to_water</span><span class="p">,</span><span class="w"> </span><span class="s2">"data/dist_to_water.tif"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div> <p><img src="/assets/img/post/20250826/06.png" alt="image" width="40%"> <img src="/assets/img/post/20250826/07.png" alt="image" width="50%"></p> <h3 id="ii-build-model">II. Build model</h3> <h4 id="1-load-required-libraries">1. Load required libraries</h4> <p>MaxEnt is implemented in Java but can be called in R through package susch as <em>dismo</em> (used here). You’ll need to download “maxent.jar” from the Maxent website and place it where <a href="https://cran.r-project.org/web/packages/dismo/index.html" rel="external nofollow noopener" target="_blank"><em>dismo</em></a> expect it. There are other Jave-free R packages implementing Maxent models, such as <a href="https://cran.r-project.org/web/packages/maxnet/index.html" rel="external nofollow noopener" target="_blank"><em>maxnet</em></a> (workflows via package <a href="https://cran.r-project.org/web/packages/ENMeval/index.html" rel="external nofollow noopener" target="_blank"><em>ENMeval</em></a>).</p> <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="n">dplyr</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">raster</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">dismo</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">rJava</span><span class="p">)</span><span class="w">
</span></code></pre></div></div> <h4 id="2-load-predictors-rasters">2. Load predictors (rasters)</h4> <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># load data</span><span class="w">
</span><span class="n">road</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">raster</span><span class="p">(</span><span class="s2">"data/road.tif"</span><span class="p">)</span><span class="w">
</span><span class="n">pred.dWater</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">raster</span><span class="p">(</span><span class="s2">"data/dist_to_water.tif"</span><span class="p">)</span><span class="w">
</span><span class="n">pred.land</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">raster</span><span class="p">(</span><span class="s2">"data/landcover.tif"</span><span class="p">)</span><span class="w">

</span><span class="c1"># keep only grid cells on road</span><span class="w">
</span><span class="n">pred</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">stack</span><span class="p">(</span><span class="n">pred.land</span><span class="p">,</span><span class="w"> </span><span class="n">pred.dWater</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">mask</span><span class="p">(</span><span class="n">road</span><span class="p">)</span><span class="w">
</span><span class="nf">names</span><span class="p">(</span><span class="n">pred</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"landcover"</span><span class="p">,</span><span class="w"> </span><span class="s2">"dis_to_water"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div> <h4 id="3-load-occurance-data-roadkill-records">3. Load occurance data (roadkill records)</h4> <p>Different taxa may respond differently to the same predictors due to different habitat preference or behaviors, so it may be better to model different groups separately. Here I’m using amphibians and reptiles (herpets) as example.</p> <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># load data</span><span class="w">
</span><span class="n">rk_herpet_raw</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read.csv</span><span class="p">(</span><span class="s2">"data_input/roadkill.csv"</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">filter</span><span class="p">(</span><span class="n">class</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"Squamata"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Amphibia"</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">rename</span><span class="p">(</span><span class="n">lon</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">decimalLongitude</span><span class="p">,</span><span class="w"> </span><span class="n">lat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">decimalLatitude</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">select</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span><span class="w"> </span><span class="n">lat</span><span class="p">)</span><span class="w">

</span><span class="c1"># keep only points that fall on valid predictor cells</span><span class="w">
</span><span class="n">on_target</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">apply</span><span class="p">(</span><span class="o">!</span><span class="nf">is.na</span><span class="p">(</span><span class="n">extract</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span><span class="w"> </span><span class="n">rk_herpet_raw</span><span class="p">)),</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">all</span><span class="p">)</span><span class="w">
</span><span class="n">rk_herpet</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">rk_herpet_raw</span><span class="p">[</span><span class="n">on_target</span><span class="p">,</span><span class="w"> </span><span class="p">]</span><span class="w">
</span></code></pre></div></div> <h4 id="4-fit-maxent-model-and-make-prediction">4. Fit MaxEnt model and make prediction</h4> <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">set.seed</span><span class="p">(</span><span class="m">123</span><span class="p">)</span><span class="w">
</span><span class="n">m.herpet</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">maxent</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pred</span><span class="p">,</span><span class="w">
                   </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rk_herpet</span><span class="p">,</span><span class="w">
                   </span><span class="n">nbg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">100000</span><span class="p">,</span><span class="w">
                   </span><span class="n">factors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"landcover"</span><span class="p">,</span><span class="w">
                   </span><span class="n">removeDuplicates</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span><span class="w">
</span><span class="n">m.herpet</span><span class="w"> </span><span class="c1"># show summary (open as an HTML page)</span><span class="w">
</span></code></pre></div></div> <ul> <li> <code class="language-plaintext highlighter-rouge">x</code>: spatial object of predictor layers</li> <li> <code class="language-plaintext highlighter-rouge">factors</code>: specify which predictor layers are categorical</li> <li> <code class="language-plaintext highlighter-rouge">p</code>: occurence data (roadkill records) in coordinates</li> <li> <code class="language-plaintext highlighter-rouge">nbg</code>: number of background points</li> <li>By default, duplicate presences within a cell are removed to reduce sampling bias; override with <code class="language-plaintext highlighter-rouge">removeDuplicates = FALSE</code>.</li> </ul> <p>The HTML summary includes model AUC, variable contributions, threshold-based diagnostics, etc.</p> <p><img src="/assets/img/post/20250826/08.png" alt="image" width="100%"></p> <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Check fitted response</span><span class="w">
</span><span class="n">response</span><span class="p">(</span><span class="n">m.herpet</span><span class="p">)</span><span class="w">
</span></code></pre></div></div> <p><img src="/assets/img/post/20250826/09.png" alt="image" width="100%"></p> <p>The left plot shows the categorical land-cover effect (here displayed as integer codes because labels were mapped to integers). We can retreive the labels to gain insight into their effects, but I’m skipping this step since this is just a demonstration.</p> <p>The right shows the continuous effect of distance to water (in meters). Let’s focus on ~0–1 km, where risk increases as roads get closer to water, which makes sense for amphibians and reptiles. At zero, the risk drops sharply likely because many near zero distance are bridges (road over water), where terrestrial animals are relatively rare. Beyong a few kilometers, effects are probably less meaningful and may reflect data sparsity rather than true patterns.</p> <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Predict roadkill risk</span><span class="w">
</span><span class="n">risk</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">predict</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span><span class="w"> </span><span class="n">m.herpet</span><span class="p">)</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">risk</span><span class="p">)</span><span class="w">
</span></code></pre></div></div> <p><img src="/assets/img/post/20250826/10.png" alt="image" width="40%"></p> <p>You can see that such plot makes roads look nearly invisible at island scale (narrow linework). So in the next part, we are gonna make some efforts to better visualize the result.</p> <h3 id="iii-visualize-risk-predictions">III. Visualize risk predictions</h3> <p>Now let’s create interactive maps that allow zooming for details. We can also add the roadkill records onto the map to provide more background information.</p> <h4 id="load-required-libraries">Load required libraries</h4> <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="n">sf</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">mapview</span><span class="p">)</span><span class="w"> </span><span class="c1"># interactive map</span><span class="w">
</span></code></pre></div></div> <h4 id="interactive-map--presence-points-raster">Interactive map + presence points (raster)</h4> <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">rk_points</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">st_as_sf</span><span class="p">(</span><span class="n">rk_herpet</span><span class="p">,</span><span class="w"> </span><span class="n">coords</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"lon"</span><span class="p">,</span><span class="w"> </span><span class="s2">"lat"</span><span class="p">),</span><span class="w"> </span><span class="n">crs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">4326</span><span class="p">)</span><span class="w">

</span><span class="n">mapviewOptions</span><span class="p">(</span><span class="n">basemaps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"CartoDB.DarkMatter"</span><span class="p">,</span><span class="w"> </span><span class="s2">"OpenStreetMap"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Esri.WorldImagery"</span><span class="p">,</span><span class="w"> </span><span class="s2">"OpenTopoMap"</span><span class="p">))</span><span class="w">
</span><span class="n">mapview</span><span class="p">(</span><span class="n">risk</span><span class="p">,</span><span class="w"> </span><span class="n">maxpixels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">9332000</span><span class="p">,</span><span class="w"> </span><span class="n">layer.name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Roadkill risk"</span><span class="p">,</span><span class="w"> </span><span class="n">na.color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"transparent"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">mapview</span><span class="p">(</span><span class="n">rk_points</span><span class="p">,</span><span class="w"> </span><span class="n">layer.name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Roadkill records (herpet)"</span><span class="p">,</span><span class="w"> </span><span class="n">cex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">.1</span><span class="p">,</span><span class="w"> </span><span class="n">col.regions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"white"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div> <iframe title="interactive map" src="https://stephchia.github.io/roadkill-sdm/roadkill_risk_herpet_rast.html" width="100%" height="400" style="border:0;" loading="lazy"> </iframe> <p>In case the embedded html does not load, you should see a zoomable map like this:</p> <p><img src="/assets/img/post/20250826/11.png" alt="image" width="100%"></p> <p>This is now better. But because rasters render as thin lines for roads, they remain hard to see at small scales. To improve readability, we convert the information into vectors (sample along road vectors and visualize smoothed segment values).</p> <h4 id="interactive-map--presence-points-vector">Interactive map + presence points (vector)</h4> <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># create road vector</span><span class="w">
</span><span class="n">road.vec</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">st_read</span><span class="p">(</span><span class="s2">"data_input/highway/highway.shp"</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">st_transform</span><span class="p">(</span><span class="n">st_crs</span><span class="p">(</span><span class="n">risk</span><span class="p">))</span><span class="w">

</span><span class="n">get_smooth_vect</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">risk</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="c1"># extract risk values along road vectors (at vertices) from risk raster</span><span class="w">
  </span><span class="n">coords</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">st_coordinates</span><span class="p">(</span><span class="n">road.vec</span><span class="p">)</span><span class="w">
  </span><span class="n">risk.points</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">extract</span><span class="p">(</span><span class="n">risk</span><span class="p">,</span><span class="w"> </span><span class="n">coords</span><span class="p">[,</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"X"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Y"</span><span class="p">)])</span><span class="w">

  </span><span class="c1"># compute risk values of segments (midpoint average between consecutive vertices)</span><span class="w">
  </span><span class="n">risk.seg</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="p">(</span><span class="n">risk.points</span><span class="p">[</span><span class="o">-</span><span class="nf">length</span><span class="p">(</span><span class="n">risk.points</span><span class="p">)]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">risk.points</span><span class="p">[</span><span class="m">-1</span><span class="p">])</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="m">2</span><span class="w">
  </span><span class="n">valid</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="p">(</span><span class="n">coords</span><span class="p">[</span><span class="o">-</span><span class="n">nrow</span><span class="p">(</span><span class="n">coords</span><span class="p">),</span><span class="w"> </span><span class="s2">"L1"</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">coords</span><span class="p">[</span><span class="m">-1</span><span class="p">,</span><span class="w"> </span><span class="s2">"L1"</span><span class="p">])</span><span class="w"> </span><span class="o">&amp;</span><span class="w">
    </span><span class="p">(</span><span class="n">coords</span><span class="p">[</span><span class="o">-</span><span class="n">nrow</span><span class="p">(</span><span class="n">coords</span><span class="p">),</span><span class="w"> </span><span class="s2">"L2"</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">coords</span><span class="p">[</span><span class="m">-1</span><span class="p">,</span><span class="w"> </span><span class="s2">"L2"</span><span class="p">])</span><span class="w">
  </span><span class="n">risk.seg</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">risk.seg</span><span class="p">[</span><span class="n">valid</span><span class="p">]</span><span class="w">

  </span><span class="c1"># create line segments</span><span class="w">
  </span><span class="n">coords_from</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">coords</span><span class="p">[</span><span class="o">-</span><span class="n">nrow</span><span class="p">(</span><span class="n">coords</span><span class="p">),</span><span class="w"> </span><span class="p">][</span><span class="n">valid</span><span class="p">,</span><span class="w"> </span><span class="p">]</span><span class="w">
  </span><span class="n">coords_to</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">coords</span><span class="p">[</span><span class="m">-1</span><span class="p">,</span><span class="w"> </span><span class="p">][</span><span class="n">valid</span><span class="p">,</span><span class="w"> </span><span class="p">]</span><span class="w">
  </span><span class="n">segments</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lapply</span><span class="p">(</span><span class="nf">seq_along</span><span class="p">(</span><span class="n">risk.seg</span><span class="p">),</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">st_linestring</span><span class="p">(</span><span class="n">rbind</span><span class="p">(</span><span class="n">coords_from</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"X"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Y"</span><span class="p">)],</span><span class="w"> </span><span class="n">coords_to</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"X"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Y"</span><span class="p">)]))</span><span class="w">
  </span><span class="p">})</span><span class="w">

  </span><span class="c1"># compute moving average</span><span class="w">
  </span><span class="n">moving_average</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">values</span><span class="p">,</span><span class="w"> </span><span class="n">window</span><span class="p">)</span><span class="w"> </span><span class="n">stats</span><span class="o">::</span><span class="n">filter</span><span class="p">(</span><span class="n">values</span><span class="p">,</span><span class="w"> </span><span class="nf">rep</span><span class="p">(</span><span class="m">1</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">window</span><span class="p">,</span><span class="w"> </span><span class="n">window</span><span class="p">),</span><span class="w"> </span><span class="n">sides</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">as.numeric</span><span class="w">
  </span><span class="n">risk.seg.smooth</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">moving_average</span><span class="p">(</span><span class="n">risk.seg</span><span class="p">,</span><span class="w"> </span><span class="n">window</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">100</span><span class="p">)</span><span class="w">
  </span><span class="n">risk.seg.smooth</span><span class="p">[</span><span class="nf">is.na</span><span class="p">(</span><span class="n">risk.seg.smooth</span><span class="p">)]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">risk.seg</span><span class="p">[</span><span class="nf">is.na</span><span class="p">(</span><span class="n">risk.seg.smooth</span><span class="p">)]</span><span class="w">

  </span><span class="c1"># return sf object</span><span class="w">
  </span><span class="n">risk_smooth_sf</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">st_sf</span><span class="p">(</span><span class="n">geometry</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">st_sfc</span><span class="p">(</span><span class="n">segments</span><span class="p">,</span><span class="w"> </span><span class="n">crs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">st_crs</span><span class="p">(</span><span class="n">road.vec</span><span class="p">)),</span><span class="w">
                          </span><span class="n">mean_value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">risk.seg.smooth</span><span class="p">)</span><span class="w">
  </span><span class="nf">return</span><span class="p">(</span><span class="n">risk_smooth_sf</span><span class="p">)</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="n">risk_smooth_herpet</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">get_smooth_vect</span><span class="p">(</span><span class="n">predict</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span><span class="w"> </span><span class="n">m.herpet</span><span class="p">))</span><span class="w">

</span><span class="n">mapview</span><span class="p">(</span><span class="n">risk_smooth_herpet</span><span class="p">,</span><span class="w"> </span><span class="n">zcol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"mean_value"</span><span class="p">,</span><span class="w"> </span><span class="n">layer.name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Roadkill risk (herpet)"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">mapview</span><span class="p">(</span><span class="n">rk_points</span><span class="p">,</span><span class="w"> </span><span class="n">layer.name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Roadkill records (herpet)"</span><span class="p">,</span><span class="w"> </span><span class="n">cex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="n">col.regions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"white"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div> <iframe title="interactive map" src="https://stephchia.github.io/roadkill-sdm/roadkill_risk_herpet_vect.html" width="100%" height="400" style="border:0;" loading="lazy"> </iframe> <p>Now you can see the roadkill risk along highways across Taiwan. You can toggle off the roadkill records (from top left layer icon) to remove points blocking the view.</p> <p>If page doesn’t load, the expected view looks like this:</p> <p><img src="/assets/img/post/20250826/12.png" alt="image" width="100%"></p> <hr> <h2 id="remarks">Remarks</h2> <h3 id="practical-implications">Practical implications</h3> <p>This is just a quick prototype, so I don’t want to overinterpret the results. But with more careful model design, tuning, and bias handling, this kind of model can have practical implications for conservation:</p> <ul> <li> <strong>Hotspot prioritization</strong>: The risk map can be used to flag road segments that warrent attention and could be targeted for preventive measures (fencing, speed reduction, animal passage, etc.).</li> <li> <strong>Clues about causes</strong>: The fitted response indicates the environmental factors correlated to risk, which help form hypotheses about animal movement and humand-wildlife interaction.</li> </ul> <h3 id="how-this-differs-from-classic-sdm">How this differs from classic SDM</h3> <p>Traditional SDMs treat presences as places a species can persist. In roadkill risk, a “presence” is a collision event—the outcome of <strong>species occurrence × movement/crossing behavior × road design/traffic × reporting effort</strong>. Because of that, some common SDM practices may need to be adapted to this specific context. Below includes a few exmaples.</p> <h3 id="caveats-and-future-directions">Caveats and future directions</h3> <ul> <li> <strong>Background bias</strong>: The default background points were sampled uniformly along roads, but reporting effort isn’t uniform—busy and accessible roads are likely reported more. A potential correction is <a href="https://onlinelibrary.wiley.com/doi/10.1111/ddi.13442" rel="external nofollow noopener" target="_blank">“target-group background”</a>, where we can draw background from all roadkill submissions to approximate reporting effort (i.e. contrasting the focal taxa with all species)—as in <a href="https://link.springer.com/article/10.1007/s10531-020-02083-6" rel="external nofollow noopener" target="_blank">Chyn et al. (2021)</a>. However, because roadkill frequency can also reflect true risk, this may absorb some signal. An alternative may be to weight background by other effort proxy (such as traffic volumn) to better reflects where people and vehicles actually are.</li> <li> <strong>Duplicates records</strong>: By default, Maxent keep one occurance record per cell to account for effort bias. But for roadkill, multiple records might reflect genuine risk signal (not just effort). Keeping all records might make sense if we can have an effort weighted background.</li> <li> <strong>Overfitting issue</strong>: Split train/test sets by space (and by time if possible) can give more honest output than random splits (especially in clustered data) to help avoid overfitting.</li> <li> <strong>Scope of this demo</strong>: I’m using a small subset of roadkill data, highway only, and just two predictors, for demonstration. Data exists for more in-depth exploration.</li> </ul> </div> </article> </div> </div> </div> </div> <footer class="sticky-bottom mt-5" role="contentinfo"> <div class="container"> © 2025 Stephanie Chia. Powered by Jekyll with al-folio theme. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script defer src="/assets/js/bootstrap-toc.min.js?c82ff4de8b0955d6ff14f5b05eed7eb6"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?c8a01c11a92744d44b093fc3bda915df" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>